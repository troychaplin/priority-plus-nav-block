(()=>{"use strict";const o=window.wp.i18n,r=window.wp.blocks,i=window.wp.primitives,t=window.ReactJSXRuntime;var e=(0,t.jsx)(i.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,t.jsx)(i.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M7.404 16.596a6.5 6.5 0 1 0 9.192-9.192 6.5 6.5 0 0 0-9.192 9.192ZM6.344 6.343a8 8 0 1 0 11.313 11.314A8 8 0 0 0 6.343 6.343Zm4.906 9.407v-3h-3v-1.5h3v-3h1.5v3h3v1.5h-3v3h-1.5Z"})});const a=window.wp.hooks,n={backgroundColor:"#ffffff",borderColor:"#dddddd",borderWidth:"1px",borderRadius:"4px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",itemSpacing:{top:"0.75rem",right:"1rem",bottom:"0.75rem",left:"1rem"},itemHoverBackgroundColor:"rgba(0, 0, 0, 0.05)",itemHoverTextColor:"inherit",multiLevelIndent:"1.25rem"};(0,r.registerBlockVariation)("core/navigation",{name:"priority-plus-navigation",title:(0,o.__)("Priority Plus Navigation","priority-plus-navigation"),description:(0,o.__)('A responsive navigation that automatically moves overflow items to a "More" dropdown.',"priority-plus-navigation"),icon:e,scope:["inserter","transform"],attributes:{className:"is-style-priority-plus-navigation",overlayMenu:"never",priorityNavEnabled:!0,priorityNavMoreLabel:"More",priorityNavMoreBackgroundColor:void 0,priorityNavMoreBackgroundColorHover:void 0,priorityNavMoreTextColor:void 0,priorityNavMoreTextColorHover:void 0,priorityNavDropdownStyles:n},isActive:(o,r)=>o.className?.includes(r.className)}),(0,a.addFilter)("blocks.registerBlockType","priority-plus-navigation/extend-core-navigation",(o,r)=>"core/navigation"!==r?o:{...o,attributes:{...o.attributes,priorityNavEnabled:{type:"boolean",default:!1},priorityNavMoreLabel:{type:"string",default:"More"},priorityNavMoreIcon:{type:"string",default:"none"},priorityNavMoreBackgroundColor:{type:"string"},priorityNavMoreBackgroundColorHover:{type:"string"},priorityNavMoreTextColor:{type:"string"},priorityNavMoreTextColorHover:{type:"string"},priorityNavMorePadding:{type:"object",default:void 0},priorityNavDropdownStyles:{type:"object",default:n},priorityNavTypographyFontFamily:{type:"string"},priorityNavTypographyFontSize:{type:"string"},priorityNavTypographyFontWeight:{type:"string"},priorityNavTypographyFontStyle:{type:"string"}}});const l=window.wp.blockEditor,p=window.wp.components,s=window.wp.compose,y=window.wp.element;function d(o){if(!o||"string"!=typeof o)return o;if(o.startsWith("var:preset|")){const r=o.match(/^var:preset\|([^|]+)\|(.+)$/);if(r)return`var(--wp--preset--${r[1]}--${r[2]})`}return o.startsWith("var("),o}function u(o){if(!o)return"0.75rem 1rem";if("string"==typeof o)return d(o);if("object"==typeof o){if(0===Object.keys(o).length)return"0.75rem 1rem";const{top:r,right:i,bottom:t,left:e}=o;if(!(r&&""!==r&&"0"!==r||i&&""!==i&&"0"!==i||t&&""!==t&&"0"!==t||e&&""!==e&&"0"!==e))return"0.75rem 1rem";const a=d(r)||"0",n=d(i)||"0",l=d(t)||"0",p=d(e)||"0";return a===n&&n===l&&l===p?a:a===l&&n===p?`${a} ${n}`:`${a} ${n} ${l} ${p}`}return"0.75rem 1rem"}function g({dropdownStyles:r,typographyStyles:i={}}){const{backgroundColor:e="#ffffff",borderColor:a="#dddddd",borderWidth:n="1px",borderRadius:l="4px",boxShadow:p="0 4px 12px rgba(0, 0, 0, 0.15)",itemSpacing:s,itemHoverBackgroundColor:d="rgba(0, 0, 0, 0.05)",itemHoverTextColor:g="inherit",multiLevelIndent:v="1.25rem"}=r||{},[c,h]=(0,y.useState)(!0),m=(0,y.useMemo)(()=>{const o={"--wp--custom--priority-plus-navigation--dropdown--background-color":e,"--wp--custom--priority-plus-navigation--dropdown--border-color":a,"--wp--custom--priority-plus-navigation--dropdown--border-width":n,"--wp--custom--priority-plus-navigation--dropdown--border-radius":l,"--wp--custom--priority-plus-navigation--dropdown--box-shadow":p,"--wp--custom--priority-plus-navigation--dropdown--item-spacing":u(s),"--wp--custom--priority-plus-navigation--dropdown--item-hover-background-color":d,"--wp--custom--priority-plus-navigation--dropdown--item-hover-text-color":g,"--wp--custom--priority-plus-navigation--dropdown--multi-level-indent":v};return i.fontFamily&&(o.fontFamily=i.fontFamily),i.fontSize&&(o.fontSize=i.fontSize),i.fontWeight&&(o.fontWeight=i.fontWeight),i.fontStyle&&(o.fontStyle=i.fontStyle),o},[e,a,n,l,p,s,d,g,v,i]);return(0,t.jsxs)("div",{className:"dropdown-preview-wrapper",children:[(0,t.jsxs)("ul",{className:"priority-plus-navigation-dropdown is-open",style:m,children:[(0,t.jsx)("li",{children:(0,t.jsx)("a",{href:"#",onClick:o=>o.preventDefault(),children:(0,o.__)("Home","priority-plus-navigation")})}),(0,t.jsx)("li",{className:"dropdown-preview-hover-demo",children:(0,t.jsx)("a",{href:"#",onClick:o=>o.preventDefault(),children:(0,o.__)("About (Hover)","priority-plus-navigation")})}),(0,t.jsxs)("li",{children:[(0,t.jsxs)("button",{type:"button",className:"priority-plus-navigation-accordion-toggle priority-plus-navigation-accordion-toggle-full",onClick:()=>h(!c),"aria-expanded":c,children:[(0,t.jsx)("span",{className:"priority-plus-navigation-accordion-text",children:(0,o.__)("Services","priority-plus-navigation")}),(0,t.jsx)("span",{className:"priority-plus-navigation-accordion-arrow","aria-hidden":"true",children:"â€º"})]}),c&&(0,t.jsxs)("ul",{className:"priority-plus-navigation-accordion-content is-open",children:[(0,t.jsx)("li",{children:(0,t.jsx)("a",{href:"#",onClick:o=>o.preventDefault(),children:(0,o.__)("Web Design","priority-plus-navigation")})}),(0,t.jsx)("li",{children:(0,t.jsx)("a",{href:"#",onClick:o=>o.preventDefault(),children:(0,o.__)("Development","priority-plus-navigation")})})]})]}),(0,t.jsx)("li",{children:(0,t.jsx)("a",{href:"#",onClick:o=>o.preventDefault(),children:(0,o.__)("Contact","priority-plus-navigation")})})]}),(0,t.jsx)("p",{className:"dropdown-preview-help",children:(0,o.__)('Live preview - Click "Services" to toggle accordion',"priority-plus-navigation")})]})}function v({attributes:r,setAttributes:i,onClose:e}){const a=r.priorityNavDropdownStyles||{},s={...n,...a,itemSpacing:a.itemSpacing||n.itemSpacing},d=(0,l.useSetting)("typography.fontSizes")||[],u=(0,l.useSetting)("typography.fontFamilies")||[];console.log("Modal - Font Sizes from theme:",d),console.log("Modal - Font Families from theme:",u),console.log("Modal - Stored typography attributes:",{priorityNavTypographyFontFamily:r.priorityNavTypographyFontFamily,priorityNavTypographyFontSize:r.priorityNavTypographyFontSize,priorityNavTypographyFontWeight:r.priorityNavTypographyFontWeight,priorityNavTypographyFontStyle:r.priorityNavTypographyFontStyle});const v={};if(r.priorityNavTypographyFontFamily){let o=[];u&&"object"==typeof u&&!Array.isArray(u)?(console.log("Modal - Font families is an object, extracting theme/custom arrays"),u.theme&&Array.isArray(u.theme)&&(console.log("Modal - Adding theme fonts:",u.theme),o=o.concat(u.theme)),u.custom&&Array.isArray(u.custom)&&(console.log("Modal - Adding custom fonts:",u.custom),o=o.concat(u.custom))):Array.isArray(u)&&(console.log("Modal - Font families is an array"),u.forEach(r=>{r.fontFamilies&&Array.isArray(r.fontFamilies)?o=o.concat(r.fontFamilies):r.slug&&r.fontFamily&&o.push(r)})),console.log("Modal - All font families collected:",o),console.log("Modal - Looking for slug:",r.priorityNavTypographyFontFamily);const i=o.find(o=>o.slug===r.priorityNavTypographyFontFamily);console.log("Modal - Found font family preset:",i),i&&(v.fontFamily=i.fontFamily)}if(r.priorityNavTypographyFontSize){let o=[];Array.isArray(d)&&d.forEach(r=>{r.sizes&&Array.isArray(r.sizes)?o=o.concat(r.sizes):r.slug&&r.size&&o.push(r)});const i=o.find(o=>o.slug===r.priorityNavTypographyFontSize);i&&(v.fontSize=i.size)}r.priorityNavTypographyFontWeight&&(v.fontWeight=r.priorityNavTypographyFontWeight),r.priorityNavTypographyFontStyle&&(v.fontStyle=r.priorityNavTypographyFontStyle),console.log("Modal - Final typography styles to pass to preview:",v),(0,l.useSetting)("spacing.spacingSizes"),(0,y.useEffect)(()=>{const o=r.priorityNavDropdownStyles||{};o.itemSpacing||i({priorityNavDropdownStyles:{...n,...o}})},[]);const c=(o,r)=>{i({priorityNavDropdownStyles:{...s,[o]:r}})},h=o=>!!s[o],m=(o,r)=>{c(o,r)};return(0,t.jsxs)(p.Modal,{title:(0,o.__)("Customize Dropdown Styles","priority-plus-navigation"),onRequestClose:e,className:"priority-plus-dropdown-customizer",size:"large",isDismissible:!0,children:[(0,t.jsxs)("div",{className:"dropdown-customizer-layout",children:[(0,t.jsxs)("div",{className:"dropdown-customizer-controls",children:[(0,t.jsx)(l.PanelColorSettings,{title:(0,o.__)("Priority Plus Menu Colors","priority-plus-navigation"),colorSettings:[{label:(0,o.__)("Background Color","priority-plus-navigation"),value:s.backgroundColor,onChange:o=>c("backgroundColor",o||"#ffffff"),clearable:!0},{label:(0,o.__)("Border Color","priority-plus-navigation"),value:s.borderColor,onChange:o=>c("borderColor",o||"#dddddd"),clearable:!0},{label:(0,o.__)("Hover Background Color","priority-plus-navigation"),value:s.itemHoverBackgroundColor,onChange:o=>c("itemHoverBackgroundColor",o||"rgba(0, 0, 0, 0.05)"),clearable:!0},{label:(0,o.__)("Hover Text Color","priority-plus-navigation"),value:s.itemHoverTextColor,onChange:o=>c("itemHoverTextColor",o||"inherit"),clearable:!0}]}),(0,t.jsxs)(p.__experimentalToolsPanel,{label:(0,o.__)("Dropdown Menu Styles","priority-plus-navigation"),resetAll:()=>{c("borderWidth","1px"),c("borderRadius","4px"),c("boxShadow","0 4px 12px rgba(0, 0, 0, 0.15)")},children:[(0,t.jsx)(p.__experimentalToolsPanelItem,{hasValue:()=>h("borderWidth"),label:(0,o.__)("Border Width","priority-plus-navigation"),onDeselect:()=>m("borderWidth","1px"),isShownByDefault:!0,children:(0,t.jsx)(p.__experimentalUnitControl,{label:(0,o.__)("Border Width","priority-plus-navigation"),value:s.borderWidth||"1px",onChange:o=>c("borderWidth",o),units:[{value:"px",label:"px"},{value:"rem",label:"rem"},{value:"em",label:"em"}]})}),(0,t.jsx)(p.__experimentalToolsPanelItem,{hasValue:()=>h("borderRadius"),label:(0,o.__)("Border Radius","priority-plus-navigation"),onDeselect:()=>m("borderRadius","4px"),isShownByDefault:!0,children:(0,t.jsx)(p.__experimentalUnitControl,{label:(0,o.__)("Border Radius","priority-plus-navigation"),value:s.borderRadius||"4px",onChange:o=>c("borderRadius",o),units:[{value:"px",label:"px"},{value:"rem",label:"rem"},{value:"%",label:"%"}]})}),(0,t.jsx)(p.__experimentalToolsPanelItem,{hasValue:()=>h("boxShadow"),label:(0,o.__)("Box Shadow","priority-plus-navigation"),onDeselect:()=>m("boxShadow","0 4px 12px rgba(0, 0, 0, 0.15)"),isShownByDefault:!0,children:(0,t.jsx)(p.TextControl,{label:(0,o.__)("Box Shadow","priority-plus-navigation"),value:s.boxShadow||"0 4px 12px rgba(0, 0, 0, 0.15)",onChange:o=>c("boxShadow",o),help:(0,o.__)("CSS box-shadow property","priority-plus-navigation")})})]})]}),(0,t.jsx)("div",{className:"dropdown-customizer-preview",children:(0,t.jsx)(g,{dropdownStyles:s,typographyStyles:v})})]}),(0,t.jsxs)("div",{className:"dropdown-customizer-footer",children:[(0,t.jsx)(p.Button,{variant:"tertiary",isDestructive:!0,onClick:()=>{i({priorityNavDropdownStyles:n})},children:(0,o.__)("Reset to Defaults","priority-plus-navigation")}),(0,t.jsx)(p.Button,{variant:"primary",onClick:e,children:(0,o.__)("Done","priority-plus-navigation")})]})]})}const c=(0,s.createHigherOrderComponent)(o=>r=>{const{name:i,attributes:e}=r;if("core/navigation"!==i)return(0,t.jsx)(o,{...r});const a=(e.className||"").includes("is-style-priority-plus-navigation")||!0===e.priorityNavEnabled;return(0,y.useEffect)(()=>{if(!a)return;const o=document.querySelector(".block-editor-block-inspector");if(!o)return;const r=o.querySelector('.components-toggle-group-control-option-base[data-value="always"]');r&&(r.style.opacity="0.4",r.style.pointerEvents="none",r.style.textDecoration="line-through",r.style.cursor="not-allowed")},[a,e.overlayMenu]),(0,t.jsx)(o,{...r})},"addDisableAlwaysOption"),h=(0,s.createHigherOrderComponent)(r=>i=>{const{name:e,attributes:a,setAttributes:s}=i;if("core/navigation"!==e)return(0,t.jsx)(r,{...i});const d=(a.className||"").includes("is-style-priority-plus-navigation")||!0===a.priorityNavEnabled;if(!d)return(0,t.jsx)(r,{...i});const{priorityNavEnabled:u,priorityNavMoreLabel:g,priorityNavMoreBackgroundColor:c,priorityNavMoreBackgroundColorHover:h,priorityNavMoreTextColor:m,priorityNavMoreTextColorHover:b,priorityNavMorePadding:f,overlayMenu:x}=a,[w,_]=(0,y.useState)(!1);(0,y.useEffect)(()=>{d&&"always"===x&&s({overlayMenu:"mobile"})},[d,x,s]),(0,y.useEffect)(()=>{if(!d)return;const o=a.style?.typography?.fontWeight,r=a.style?.typography?.fontStyle;console.log("Typography Capture - All Attributes:",a),console.log("Typography Capture - Source values:",{fontSize:a.fontSize,fontFamily:a.fontFamily,fontWeight:o,fontStyle:r}),console.log("Typography Capture - Currently stored values:",{priorityNavTypographyFontFamily:a.priorityNavTypographyFontFamily,priorityNavTypographyFontSize:a.priorityNavTypographyFontSize,priorityNavTypographyFontWeight:a.priorityNavTypographyFontWeight,priorityNavTypographyFontStyle:a.priorityNavTypographyFontStyle}),a.fontSize===a.priorityNavTypographyFontSize&&a.fontFamily===a.priorityNavTypographyFontFamily&&o===a.priorityNavTypographyFontWeight&&r===a.priorityNavTypographyFontStyle||(console.log("Typography Capture - Updating stored values"),s({priorityNavTypographyFontFamily:a.fontFamily,priorityNavTypographyFontSize:a.fontSize,priorityNavTypographyFontWeight:o,priorityNavTypographyFontStyle:r}))},[d,a.fontSize,a.fontFamily,a.style?.typography?.fontWeight,a.style?.typography?.fontStyle,a.priorityNavTypographyFontFamily,a.priorityNavTypographyFontSize,a.priorityNavTypographyFontWeight,a.priorityNavTypographyFontStyle,s]);const N=(0,l.useSetting)("spacing.spacingSizes")||[];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r,{...i}),(0,t.jsx)(l.InspectorControls,{group:"settings",children:(0,t.jsx)(p.Notice,{status:"info",isDismissible:!1,children:(0,o.__)('Priority Plus Navigation is not compatible with "Always" overlay menu. The overlay menu is set to "Mobile" to allow Priority+ to work on desktop.',"priority-plus-navigation")})}),(0,t.jsxs)(l.InspectorControls,{group:"styles",children:[(0,t.jsx)(p.__experimentalToolsPanel,{label:(0,o.__)("Priority Plus Settings","priority-plus-navigation"),resetAll:()=>s({priorityNavMoreLabel:"More"}),children:(0,t.jsx)(p.__experimentalToolsPanelItem,{hasValue:()=>!!g,label:(0,o.__)("More Button Label","priority-plus-navigation"),onDeselect:()=>s({priorityNavMoreLabel:"More"}),isShownByDefault:!0,children:(0,t.jsx)(p.TextControl,{label:(0,o.__)("More Button Label","priority-plus-navigation"),value:g,onChange:o=>s({priorityNavMoreLabel:o}),help:(0,o.__)('Text displayed on the "More" button',"priority-plus-navigation")})})}),(0,t.jsx)(l.PanelColorSettings,{title:(0,o.__)("Priority Plus Colors","priority-plus-navigation"),colorSettings:[{label:(0,o.__)("Button Text Color","priority-plus-navigation"),value:m,onChange:o=>s({priorityNavMoreTextColor:o||void 0}),clearable:!0},{label:(0,o.__)("Button Text Hover Color","priority-plus-navigation"),value:b,onChange:o=>s({priorityNavMoreTextColorHover:o||void 0}),clearable:!0},{label:(0,o.__)("Button Background Color","priority-plus-navigation"),value:c,onChange:o=>s({priorityNavMoreBackgroundColor:o||void 0}),clearable:!0},{label:(0,o.__)("Button Background Hover Color","priority-plus-navigation"),value:h,onChange:o=>s({priorityNavMoreBackgroundColorHover:o||void 0}),clearable:!0}]}),(0,t.jsx)(p.__experimentalToolsPanel,{label:(0,o.__)("Priority Plus Button","priority-plus-navigation"),resetAll:()=>s({priorityNavMorePadding:void 0}),children:(0,t.jsx)(p.__experimentalToolsPanelItem,{hasValue:()=>!!f&&Object.keys(f).length>0,label:(0,o.__)("Padding","priority-plus-navigation"),onDeselect:()=>s({priorityNavMorePadding:void 0}),isShownByDefault:!0,children:N.length>0?(0,t.jsx)(l.__experimentalSpacingSizesControl,{values:f,onChange:o=>s({priorityNavMorePadding:o}),label:(0,o.__)("Button Padding","priority-plus-navigation"),sides:["top","right","bottom","left"],units:["px","em","rem","vh","vw"]}):(0,t.jsx)(p.BoxControl,{label:(0,o.__)("Button Padding","priority-plus-navigation"),values:f,onChange:o=>s({priorityNavMorePadding:o}),sides:["top","right","bottom","left"],units:["px","em","rem","vh","vw"],allowReset:!0})})}),(0,t.jsx)(p.__experimentalToolsPanel,{label:(0,o.__)("Dropdown Styles","priority-plus-navigation"),resetAll:()=>{s({priorityNavDropdownStyles:n})},children:(0,t.jsx)(p.__experimentalToolsPanelItem,{hasValue:()=>{const{priorityNavDropdownStyles:o}=a;return!!o&&Object.keys(o).length>0},label:(0,o.__)("Customize Dropdown","priority-plus-navigation"),onDeselect:()=>s({priorityNavDropdownStyles:void 0}),isShownByDefault:!0,children:(0,t.jsx)(p.Button,{variant:"secondary",onClick:()=>_(!0),style:{width:"100%"},children:(0,o.__)("Customize Dropdown Styles","priority-plus-navigation")})})})]}),w&&(0,t.jsx)(v,{attributes:a,setAttributes:s,onClose:()=>_(!1)})]})},"withPriorityNavControls");(0,a.addFilter)("editor.BlockEdit","priority-plus-navigation/add-disable-always-option",c,5),(0,a.addFilter)("editor.BlockEdit","priority-plus-navigation/add-priority-plus-navigation-controls",h,10)})();